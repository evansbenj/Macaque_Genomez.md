# Here is a plot that makes the pi fig
```R
library(ggplot2)
library(reshape)
setwd('/Users/Shared/Previously\ Relocated\ Items/Security/projects/2017_SEAsian_macaque_genomz/Fst_windows')

# this script will make a faceted plot of pi vs position for all of the interesting genes
window <- 10000000
options(scipen = 999) 

# initilize a dataframe for plotting
big_df <- data.frame(scaffold=character(),
                 start=numeric(), 
                 end=numeric(), 
                 Species=character(),
                 color=character(),
                 gener=character(),
                 value=numeric()
                 ) 
# all 11
#gene_vector <- c("NDUFAF3","NDUFA2","TACO1","HARS2","COX16","C11orf83","MRPS21","UQCRC1","ATP5B","MRPL48","NDUFB11")
#chr_vector <- c("chr03","chr05","chr17","chr05","chr14","chr11","chr01","chr03","chr12","chr11","chrX")
#beginning_vector <- c(104846075,138178553,56920802,138224999,132330617,11484179,124258900,104359835,54910245,65083808,47194137)
#end_vector <- c(104847927,138180781,56928897,138233197,132354632,11486231,124272013,104371673,54920096,65165565,47196604)

# just 6 good ones
#gene_vector <- c("NDUFAF3","NDUFA2","HARS2","MRPS21","UQCRC1","ATP5B")
#chr_vector <- c("chr03","chr05","chr05","chr01","chr03","chr12")
#beginning_vector <- c(104846075,138178553,138224999,124258900,104359835,54910245)
#end_vector <- c(104847927,138180781,138233197,124272013,104371673,54920096)

### NDUFAF3 and UQCRC1 are in the same place ### 
### NDUFA2 and HARS2 are in the same place ### 

# just 4 good regions with 6 genes
gene_vector <- c("NDUFAF3, UQCRC1","NDUFA2,HARS2","MRPS21","ATP5B")
chr_vector <- c("chr03","chr05","chr01","chr12")
beginning_vector <- c(104846075,138178553,124258900,54910245)
end_vector <- c(104847927,138180781,124272013,54920096)

genez_df <- cbind(gene_vector,chr_vector,beginning_vector,end_vector)
v_line_info <- cbind(paste(gene_vector,chr_vector,sep="; "),beginning_vector,end_vector)
colnames(v_line_info)[1] <- "gene"
colnames(v_line_info)[2] <- "start"
v_line_info<-as.data.frame(v_line_info)
v_line_info$start <- as.numeric(as.character(v_line_info$start))


# additional lines (same beginning for singletons, different for pairs)
gene_vector3 <- c("NDUFAF3, UQCRC1","NDUFA2,HARS2")
chr_vector3 <- c("chr03","chr05")
beginning_vector3 <- c(104359835,138224999)
end_vector3 <- c(104371673,138233197)
genez_df3 <- cbind(gene_vector3,chr_vector3,beginning_vector3,end_vector3)
v_line_info3 <- cbind(paste(gene_vector3,chr_vector3,sep="; "),beginning_vector3,end_vector3)
colnames(v_line_info3)[1] <- "gene"
colnames(v_line_info3)[2] <- "start"
v_line_info3<-as.data.frame(v_line_info3)
v_line_info3$start <- as.numeric(as.character(v_line_info3$start))


# now make additional lines for flanking genes near each gene
gene_vector5 <- rep("MRPS21",317)
chr_vector5 <- rep("chr01",317)
beginning_vector5 <- c("114340283","114404661","114457242","114527843","114549266","114559841","114597827","114637320","114753341","115039976","115220956","115359260","115371421","115423229","115507886","115665517","115682119","115977223","116388883","116526292","116665714","116799413","117054933","117195772","117255561","117435871","117595944","117684342","117743099","117795914","117830116","118053511","118335236","118605778","118717132","119670424","119813117","120130881","120174696","120268290","120409293","120507180","120540838","120608907","120703721","120721622","120965808","121085759","121232869","121259907","121585977","121614278","121663181","121996960","122103845","122218777","122364235","122971058","122985390","123019636","123027733","123035821","123059685","123089877","123100234","123106360","123126966","123217861","123250998","123285885","123737632","123786339","123786351","123793490","123794969","123834840","123837346","123837841","123846363","123849629","123869750","123875023","123887338","124020134","124107350","124179475","124222349","124229518","124236604","124247397","124258900","124285572","124330000","124457341","124478445","124526130","124549038","124671096","124699556","124752257","124780985","124848929","124862383","124979662","125021560","125039532","125055160","125066948","125099398","125112139","125115647","125124329","125134532","125205774","125231224","125231224","125234847","125240923","125245144","125250646","125276344","125334074","125365581","125375390","125422350","125446370","125482996","125486157","125600344","125630027","125702644","125795133","125818355","125861377","125874090","125901437","125907219","125940349","125977375","126099904","126182549","126232246","126542981","126637173","126640997","126688929","126703307","126725607","126738896","126744866","126779697","126802825","126834971","126869969","126886720","126896625","126922814","126950120","127070642","127083971","127101993","127135169","127142549","127178654","127196072","127303166","127367611","127380639","127422818","127463013","127504828","127533467","127563833","127622761","127698711","127701230","127707676","127711433","127724986","127780749","127788046","127792578","127804860","127809304","127828691","127831806","127848715","127897260","127947497","127981570","128103675","128121870","128133497","128142385","128147225","128154711","128164469","128166421","128333296","128379005","128387463","128402516","128462053","128519336","128526156","128607784","128679860","128702952","128777490","128791643","128899061","129187025","129222074","129227322","129240177","129248297","129257838","129266548","129282873","129298635","129317227","129329604","129345895","129396518","129404734","129408784","129440793","129446081","129457370","129464281","129484053","129503381","129512106","129519445","129534773","129546620","129571669","129583287","129597084","129829527","129911615","129999127","130043109","130058415","130092571","130097806","130173703","130203795","130224932","130231608","130242805","130289360","130329374","130368347","130391087","130391087","130424160","130425316","130430945","130470232","130479141","130498672","130525602","130553803","130653157","130716251","130781031","130807621","130831905","130858893","130891508","130914432","130920318","130929064","130934163","130960973","130999001","131034430","131054634","131102063","131118507","131132118","131285451","131318009","131719530","131879782","131995466","132032024","132191406","132382123","132563986","132579538","132724307","132815584","132830496","132875709","132879979","132986580","133037087","133045505","133056510","133103492","133201081","133270770","133321166","133429137","133463003","133565230","133868216","133996123","134060083","134105800","134113889","134133828","134151883","134198516","134207387")
end_vector5 <- c("114340283","114404661","114457242","114527843","114549266","114559841","114597827","114637320","114753341","115039976","115220956","115359260","115371421","115423229","115507886","115665517","115682119","115977223","116388883","116526292","116665714","116799413","117054933","117195772","117255561","117435871","117595944","117684342","117743099","117795914","117830116","118053511","118335236","118605778","118717132","119670424","119813117","120130881","120174696","120268290","120409293","120507180","120540838","120608907","120703721","120721622","120965808","121085759","121232869","121259907","121585977","121614278","121663181","121996960","122103845","122218777","122364235","122971058","122985390","123019636","123027733","123035821","123059685","123089877","123100234","123106360","123126966","123217861","123250998","123285885","123737632","123786339","123786351","123793490","123794969","123834840","123837346","123837841","123846363","123849629","123869750","123875023","123887338","124020134","124107350","124179475","124222349","124229518","124236604","124247397","124258900","124285572","124330000","124457341","124478445","124526130","124549038","124671096","124699556","124752257","124780985","124848929","124862383","124979662","125021560","125039532","125055160","125066948","125099398","125112139","125115647","125124329","125134532","125205774","125231224","125231224","125234847","125240923","125245144","125250646","125276344","125334074","125365581","125375390","125422350","125446370","125482996","125486157","125600344","125630027","125702644","125795133","125818355","125861377","125874090","125901437","125907219","125940349","125977375","126099904","126182549","126232246","126542981","126637173","126640997","126688929","126703307","126725607","126738896","126744866","126779697","126802825","126834971","126869969","126886720","126896625","126922814","126950120","127070642","127083971","127101993","127135169","127142549","127178654","127196072","127303166","127367611","127380639","127422818","127463013","127504828","127533467","127563833","127622761","127698711","127701230","127707676","127711433","127724986","127780749","127788046","127792578","127804860","127809304","127828691","127831806","127848715","127897260","127947497","127981570","128103675","128121870","128133497","128142385","128147225","128154711","128164469","128166421","128333296","128379005","128387463","128402516","128462053","128519336","128526156","128607784","128679860","128702952","128777490","128791643","128899061","129187025","129222074","129227322","129240177","129248297","129257838","129266548","129282873","129298635","129317227","129329604","129345895","129396518","129404734","129408784","129440793","129446081","129457370","129464281","129484053","129503381","129512106","129519445","129534773","129546620","129571669","129583287","129597084","129829527","129911615","129999127","130043109","130058415","130092571","130097806","130173703","130203795","130224932","130231608","130242805","130289360","130329374","130368347","130391087","130391087","130424160","130425316","130430945","130470232","130479141","130498672","130525602","130553803","130653157","130716251","130781031","130807621","130831905","130858893","130891508","130914432","130920318","130929064","130934163","130960973","130999001","131034430","131054634","131102063","131118507","131132118","131285451","131318009","131719530","131879782","131995466","132032024","132191406","132382123","132563986","132579538","132724307","132815584","132830496","132875709","132879979","132986580","133037087","133045505","133056510","133103492","133201081","133270770","133321166","133429137","133463003","133565230","133868216","133996123","134060083","134105800","134113889","134133828","134151883","134198516","134207387")
genez_df5 <- cbind(gene_vector5,chr_vector5,beginning_vector5,end_vector5)
v_line_info5 <- cbind(paste(gene_vector5,chr_vector5,sep="; "),beginning_vector5,end_vector5)
colnames(v_line_info5)[1] <- "gene"
colnames(v_line_info5)[2] <- "start"
v_line_info5<-as.data.frame(v_line_info5)
v_line_info5$start <- as.numeric(as.character(v_line_info5$start))

# now make additional lines for flanking genes near each gene
gene_vector4 <- rep("NDUFAF3, UQCRC1",236)
chr_vector4 <- rep("chr03",236)
beginning_vector4 <- c("94863186","94898457","94922920","95048481","95466607","95840452","95914280","95984793","96002687","96036144","96054936","96730561","96777556","97724042","97832982","97976034","98091624","98136867","98180434","98192384","98251199","98278395","98285461","98301269","98375417","98453814","98462765","98489623","98521096","98561828","98661475","98868156","98946895","99244971","99900558","100063769","100188107","100213737","100254375","100278092","100343716","100364275","100382746","100393292","100504265","100521715","100574225","100624605","100673964","100759331","101043313","101247357","101344533","101413276","101479966","101543285","101577509","101603246","101684125","101860734","101907382","102027020","102044057","102077678","102099171","102157614","102174605","102242380","102336250","102369248","102379590","102387186","102409985","102483751","102508169","102534148","102604670","102662566","102918814","102972796","103079762","103113916","103202044","103258450","103284342","103511367","103678975","103877313","103960909","104042588","104156943","104185387","104200314","104221909","104224187","104278557","104321675","104359835","104382865","104389401","104400068","104437199","104457765","104513790","104624674","104813232","104831194","104839452","104846075","104854084","104925971","104938943","104951327","104985093","104994550","105022106","105100015","105196049","105197979","105260646","105265388","105272700","105373863","105538930","105548715","105555923","105583957","105588603","105591422","105681153","105683099","105706791","105737639","105767329","105789852","105821479","105962416","106034853","106072843","106087277","106119365","106163103","106170942","106175951","106179546","106183062","106204193","106211295","106216912","106228232","106235024","106238920","106242209","106443524","106457051","106494649","106505438","106565251","107274435","107280395","107427806","107559628","107597544","107721066","107787084","107825202","107852338","107874347","107911778","107921120","107934777","107936938","107947976","107954528","107964346","107986387","108042618","108068507","108190345","108213931","108221444","108247728","108288930","108317883","108407001","108417250","108461254","108465798","108506204","108536347","108548500","108557725","108708594","108717364","108727423","108814752","108829486","108847704","108868266","108868276","108871933","108942776","109135587","109235726","109277237","109344662","109870465","109902584","109925056","109942703","110182131","110964911","111495803","112605478","112655646","112759175","113132270","113172779","113280391","113309219","113350654","113569133","113626305","113639788","113685687","113821756","114074179","114263126","114334715","114382945","114417912","114518814","114603651","114610662","114666475","114736639")
end_vector4 <- c("94863186","94898457","94922920","95048481","95466607","95840452","95914280","95984793","96002687","96036144","96054936","96730561","96777556","97724042","97832982","97976034","98091624","98136867","98180434","98192384","98251199","98278395","98285461","98301269","98375417","98453814","98462765","98489623","98521096","98561828","98661475","98868156","98946895","99244971","99900558","100063769","100188107","100213737","100254375","100278092","100343716","100364275","100382746","100393292","100504265","100521715","100574225","100624605","100673964","100759331","101043313","101247357","101344533","101413276","101479966","101543285","101577509","101603246","101684125","101860734","101907382","102027020","102044057","102077678","102099171","102157614","102174605","102242380","102336250","102369248","102379590","102387186","102409985","102483751","102508169","102534148","102604670","102662566","102918814","102972796","103079762","103113916","103202044","103258450","103284342","103511367","103678975","103877313","103960909","104042588","104156943","104185387","104200314","104221909","104224187","104278557","104321675","104359835","104382865","104389401","104400068","104437199","104457765","104513790","104624674","104813232","104831194","104839452","104846075","104854084","104925971","104938943","104951327","104985093","104994550","105022106","105100015","105196049","105197979","105260646","105265388","105272700","105373863","105538930","105548715","105555923","105583957","105588603","105591422","105681153","105683099","105706791","105737639","105767329","105789852","105821479","105962416","106034853","106072843","106087277","106119365","106163103","106170942","106175951","106179546","106183062","106204193","106211295","106216912","106228232","106235024","106238920","106242209","106443524","106457051","106494649","106505438","106565251","107274435","107280395","107427806","107559628","107597544","107721066","107787084","107825202","107852338","107874347","107911778","107921120","107934777","107936938","107947976","107954528","107964346","107986387","108042618","108068507","108190345","108213931","108221444","108247728","108288930","108317883","108407001","108417250","108461254","108465798","108506204","108536347","108548500","108557725","108708594","108717364","108727423","108814752","108829486","108847704","108868266","108868276","108871933","108942776","109135587","109235726","109277237","109344662","109870465","109902584","109925056","109942703","110182131","110964911","111495803","112605478","112655646","112759175","113132270","113172779","113280391","113309219","113350654","113569133","113626305","113639788","113685687","113821756","114074179","114263126","114334715","114382945","114417912","114518814","114603651","114610662","114666475","114736639")
genez_df4 <- cbind(gene_vector4,chr_vector4,beginning_vector4,end_vector4)
v_line_info4 <- cbind(paste(gene_vector4,chr_vector4,sep="; "),beginning_vector4,end_vector4)
colnames(v_line_info4)[1] <- "gene"
colnames(v_line_info4)[2] <- "start"
v_line_info4<-as.data.frame(v_line_info4)
v_line_info4$start <- as.numeric(as.character(v_line_info4$start))



# now make additional lines for flanking genes near each gene
gene_vector6 <- rep("ATP5B",275)
chr_vector6 <- rep("chr12",275)
beginning_vector6 <- c("45137172","45274852","45790769","45839234","45865962","45902451","45972268","46098948","46107974","46183710","46265243","46294357","46326948","46514462","46522159","46702359","46764288","46846799","46882384","46959542","47014992","47026296","47052390","47096495","47112577","47127148","47156893","47170356","47187034","47194500","47258536","47282253","47289696","47319290","47376619","47456716","47484999","47491228","47534923","47557924","47740286","47759567","47791360","47935160","47987607","48036375","48060289","48139942","48150558","48162053","48178452","48246305","48273819","48292673","48300943","48320987","48366019","48601906","48708514","48996986","49061992","49134377","49162435","49188651","49255561","49268424","49304001","49402498","49456003","49462589","49500052","49568321","49643074","49861763","50013290","50104069","50147680","50203201","50244248","50264121","50336802","50401233","50451837","50480864","50526431","50544924","50561012","50588894","50611926","50633672","50681008","50706249","50728134","50747853","50770001","50800248","50830837","50845685","50920056","50941475","50958707","50973572","50991711","51049672","51099106","51140868","51184232","51198778","51234220","51240116","51283239","51315629","51326303","51349726","51391181","51408555","51437736","51442251","51450659","51470730","51523714","51569839","51589105","51604543","51633843","51654094","51659530","51828101","52112946","52129112","52147504","52159545","52174602","52183603","52202940","52207551","52228680","52359931","52413077","52467330","52479183","52516554","52555346","52562822","52590771","52653684","52694876","52749654","52779917","52832894","52847163","53157985","53228755","53332529","53400568","53435048","53499899","53530334","53540795","53649353","53725547","53753444","53782966","53861297","53910447","53944950","53949261","53954638","53988500","54055013","54057938","54072531","54129523","54160235","54181753","54193861","54201262","54231059","54251086","54272681","54315711","54338129","54357742","54359287","54369758","54397349","54403087","54406585","54443232","54482406","54488242","54499822","54527159","54531566","54573494","54578652","54604111","54608465","54627364","54688907","54724677","54745011","54747432","54829841","54864699","54910245","54929134","54990612","55026092","55141988","55169942","55249302","55264693","55285448","55311356","55346261","55352441","55389648","55479130","55492113","55497421","55505997","55516957","55704027","55726750","55734832","55743381","55759483","55786479","55794543","55800558","55821441","55865408","55879378","55886420","55894448","55900266","55975675","56008762","56028264","56031021","56038395","56045972","56052181","56056218","56066394","56079804","56103617","56216309","56237324","57265033","58110057","60084320","60653242","60856356","60992678","61036026","61587449","62001638","62084017","62428775","62497666","62633830","62676348","62829058","62930332","63056010","63293479","63427323","64072247","64371114","64382888","64431257","64535145","64580529")
end_vector6 <- c("45137172","45274852","45790769","45839234","45865962","45902451","45972268","46098948","46107974","46183710","46265243","46294357","46326948","46514462","46522159","46702359","46764288","46846799","46882384","46959542","47014992","47026296","47052390","47096495","47112577","47127148","47156893","47170356","47187034","47194500","47258536","47282253","47289696","47319290","47376619","47456716","47484999","47491228","47534923","47557924","47740286","47759567","47791360","47935160","47987607","48036375","48060289","48139942","48150558","48162053","48178452","48246305","48273819","48292673","48300943","48320987","48366019","48601906","48708514","48996986","49061992","49134377","49162435","49188651","49255561","49268424","49304001","49402498","49456003","49462589","49500052","49568321","49643074","49861763","50013290","50104069","50147680","50203201","50244248","50264121","50336802","50401233","50451837","50480864","50526431","50544924","50561012","50588894","50611926","50633672","50681008","50706249","50728134","50747853","50770001","50800248","50830837","50845685","50920056","50941475","50958707","50973572","50991711","51049672","51099106","51140868","51184232","51198778","51234220","51240116","51283239","51315629","51326303","51349726","51391181","51408555","51437736","51442251","51450659","51470730","51523714","51569839","51589105","51604543","51633843","51654094","51659530","51828101","52112946","52129112","52147504","52159545","52174602","52183603","52202940","52207551","52228680","52359931","52413077","52467330","52479183","52516554","52555346","52562822","52590771","52653684","52694876","52749654","52779917","52832894","52847163","53157985","53228755","53332529","53400568","53435048","53499899","53530334","53540795","53649353","53725547","53753444","53782966","53861297","53910447","53944950","53949261","53954638","53988500","54055013","54057938","54072531","54129523","54160235","54181753","54193861","54201262","54231059","54251086","54272681","54315711","54338129","54357742","54359287","54369758","54397349","54403087","54406585","54443232","54482406","54488242","54499822","54527159","54531566","54573494","54578652","54604111","54608465","54627364","54688907","54724677","54745011","54747432","54829841","54864699","54910245","54929134","54990612","55026092","55141988","55169942","55249302","55264693","55285448","55311356","55346261","55352441","55389648","55479130","55492113","55497421","55505997","55516957","55704027","55726750","55734832","55743381","55759483","55786479","55794543","55800558","55821441","55865408","55879378","55886420","55894448","55900266","55975675","56008762","56028264","56031021","56038395","56045972","56052181","56056218","56066394","56079804","56103617","56216309","56237324","57265033","58110057","60084320","60653242","60856356","60992678","61036026","61587449","62001638","62084017","62428775","62497666","62633830","62676348","62829058","62930332","63056010","63293479","63427323","64072247","64371114","64382888","64431257","64535145","64580529")
genez_df6 <- cbind(gene_vector6,chr_vector6,beginning_vector6,end_vector6)
v_line_info6 <- cbind(paste(gene_vector6,chr_vector6,sep="; "),beginning_vector6,end_vector6)
colnames(v_line_info6)[1] <- "gene"
colnames(v_line_info6)[2] <- "start"
v_line_info6<-as.data.frame(v_line_info6)
v_line_info6$start <- as.numeric(as.character(v_line_info6$start))


# now make additional lines for flanking genes near each gene
gene_vector7 <- rep("NDUFA2,HARS2",216)
chr_vector7 <- rep("chr05",216)
beginning_vector7 <- c("128658591","128760932","128906883","129128885","129442338","129547377","129560040","129675513","129740817","129777309","129852522","129962822","130015156","130030822","130142023","130158203","130175525","130229985","130233358","130296682","130305678","130344951","130350642","130357789","130359486","130531112","130682278","131438215","131455796","131597773","131639532","131676409","131805383","131871157","131901987","132028724","132108294","132157493","132241140","132262122","132354800","132379450","132465726","132529444","132834883","133038707","133075365","133390791","133433924","133446477","133525857","133648479","133708972","134481621","135105462","135237591","135362187","135383775","135430367","135573140","135605064","135652747","135674765","135683847","135847092","135859278","135947660","135974569","136017181","136067832","136265948","136377347","136454682","136801963","136849562","136875966","136939639","136943958","136948770","136964305","137004845","137031678","137096957","137188360","137338598","137389058","137660492","137674822","137722568","137789731","137881259","137908535","137955479","137955479","138093302","138095218","138104141","138111710","138165305","138172674","138178553","138181040","138198612","138205026","138208264","138224999","138234651","138324297","138333000","138345237","138360704","138366834","138373158","138380064","138386702","138394675","138406878","138413960","138420880","138462496","138500199","138585412","138629647","138635632","138653611","138666939","138681648","138704105","138709291","138717116","138717312","138721751","138729760","138737719","138742947","138752281","138771807","138827627","138843644","138855833","138864639","138869848","138875269","138880155","138885691","138889878","138899270","138907754","138912654","138916762","138923001","138927909","138933177","138938132","138942592","138945867","139006361","139016132","139020203","139163102","139180065","139182413","139196774","139411822","139475395","139522416","139555786","139665831","139866603","140166849","140331578","140842905","141712082","141766545","143546646","143650300","143719702","143874715","143905805","143993861","144135940","144247659","144314700","144407311","145042928","145199114","145373670","145604223","145653465","145667913","145939060","145975243","146141912","146192510","146207783","146259945","146356819","146685013","146836139","147137342","147207679","147220244","147236713","147361946","147450020","147595742","147723170","147848001","147861087","147871135","147924005","147986046","148038926","148062780","148091753","148167948")
end_vector7 <- c("128658591","128760932","128906883","129128885","129442338","129547377","129560040","129675513","129740817","129777309","129852522","129962822","130015156","130030822","130142023","130158203","130175525","130229985","130233358","130296682","130305678","130344951","130350642","130357789","130359486","130531112","130682278","131438215","131455796","131597773","131639532","131676409","131805383","131871157","131901987","132028724","132108294","132157493","132241140","132262122","132354800","132379450","132465726","132529444","132834883","133038707","133075365","133390791","133433924","133446477","133525857","133648479","133708972","134481621","135105462","135237591","135362187","135383775","135430367","135573140","135605064","135652747","135674765","135683847","135847092","135859278","135947660","135974569","136017181","136067832","136265948","136377347","136454682","136801963","136849562","136875966","136939639","136943958","136948770","136964305","137004845","137031678","137096957","137188360","137338598","137389058","137660492","137674822","137722568","137789731","137881259","137908535","137955479","137955479","138093302","138095218","138104141","138111710","138165305","138172674","138178553","138181040","138198612","138205026","138208264","138224999","138234651","138324297","138333000","138345237","138360704","138366834","138373158","138380064","138386702","138394675","138406878","138413960","138420880","138462496","138500199","138585412","138629647","138635632","138653611","138666939","138681648","138704105","138709291","138717116","138717312","138721751","138729760","138737719","138742947","138752281","138771807","138827627","138843644","138855833","138864639","138869848","138875269","138880155","138885691","138889878","138899270","138907754","138912654","138916762","138923001","138927909","138933177","138938132","138942592","138945867","139006361","139016132","139020203","139163102","139180065","139182413","139196774","139411822","139475395","139522416","139555786","139665831","139866603","140166849","140331578","140842905","141712082","141766545","143546646","143650300","143719702","143874715","143905805","143993861","144135940","144247659","144314700","144407311","145042928","145199114","145373670","145604223","145653465","145667913","145939060","145975243","146141912","146192510","146207783","146259945","146356819","146685013","146836139","147137342","147207679","147220244","147236713","147361946","147450020","147595742","147723170","147848001","147861087","147871135","147924005","147986046","148038926","148062780","148091753","148167948")
genez_df7 <- cbind(gene_vector7,chr_vector7,beginning_vector7,end_vector7)
v_line_info7 <- cbind(paste(gene_vector7,chr_vector7,sep="; "),beginning_vector7,end_vector7)
colnames(v_line_info7)[1] <- "gene"
colnames(v_line_info7)[2] <- "start"
v_line_info7<-as.data.frame(v_line_info7)
v_line_info7$start <- as.numeric(as.character(v_line_info7$start))


for(i in 1:nrow(genez_df)) {
    row <- as.vector(genez_df[i,])
    #  print(row[4]) # 1 is the gene name, 2 is the chr, 3 is the beginning, 4 is the end
    
    # open the data for this gene
    mydat1<-read.table(paste("./fst_bor/popgenWindows_",eval(row[2]), "_nem_hec_windowstats.csv", sep=""),sep=",", header=T)
    mydat2<-read.table(paste("./fst_bor/popgenWindows_",eval(row[2]), "_nem_mau_windowstats.csv", sep=""),sep=",", header=T)
    mydat3<-read.table(paste("./fst_bor/popgenWindows_",eval(row[2]), "_nem_ton_windowstats.csv", sep=""),sep=",", header=T)
    mydat4<-read.table(paste("./fst_bor/popgenWindows_",eval(row[2]), "_nem_nig_windowstats.csv", sep=""),sep=",", header=T)
    
    # merge the dfs for this gene
    temp_dat1 <- merge(mydat1, mydat2, by = c("scaffold","start","end"), all=T)
    temp_dat2 <- merge(mydat3, mydat4, by = c("scaffold","start","end"), all=T)
    all_dat <- merge(temp_dat1, temp_dat2, by = c("scaffold","start","end"), all=T)
    
    # reassign columnnames
    colnames(all_dat)[6] <- "bor"
    colnames(all_dat)[7] <- "hec"
    colnames(all_dat)[13] <- "mau"
    colnames(all_dat)[25] <- "nig"
    colnames(all_dat)[19] <- "ton"
    
    # subset the data
    # First and Third Column with All rows
    my_little_bit <- all_dat[,c("scaffold","start","end","bor","hec","ton","mau","nig")]
    my_plot_data <- subset(my_little_bit, (start >= as.numeric(row[3])-window)&(end <= as.numeric(row[4])+window))
    my_ready_to_plot <- melt(my_plot_data, id=c("scaffold","start","end"))
    colnames(my_ready_to_plot)[4] <- "Species"
    
    # add a colum for colors to match the depth plot
    my_ready_to_plot$color <- NA
    my_ready_to_plot$color[my_ready_to_plot$Species == "bor"] <- "blue"
    my_ready_to_plot$color[my_ready_to_plot$Species == "mau"] <- "orange"
    my_ready_to_plot$color[my_ready_to_plot$Species == "ton"] <- "black"
    my_ready_to_plot$color[my_ready_to_plot$Species == "hec"] <- "maroon"
    my_ready_to_plot$color[my_ready_to_plot$Species == "nig"] <- "purple"

    # add a gene column for use in faceting
    my_ready_to_plot$gene <- paste(row[1],row[2],sep="; ")
    
    # add each gene to a big_df dataframe
    big_df <- rbind(big_df,my_ready_to_plot) 
}

#View(big_df)

p <- ggplot(big_df, aes(x=start/1000000, y=value, by=Species, color=Species)) +
  geom_smooth(span=.1,  size=0.5) + #se=F,
  labs( x = "Position (Mb)", y = expression(pi)) +
  ylim(0,0.1) +
  scale_y_continuous(breaks = c(0,0.05,0.10)) +
  facet_wrap( ~ gene, scales = "free_x") +
  theme_bw() +
  theme(strip.background =element_rect(fill="white"),
        strip.text = element_text(size = 20),
        axis.text = element_text (size = 20),
        axis.text.x = element_text(size = 20),
        axis.title = element_text (size = 20),
        axis.title.x = element_text(size = 30),
        axis.title.y = element_text(size = 30),
        legend.title=element_text(size=20),
        legend.text=element_text(size=20),
        legend.justification = "top")
  

png(filename="pi_closeup.png",
    width = 500, height = 300, units='mm', res = 100)  
    p + geom_segment(aes(x = start/1000000, y = 0.11, xend = start/1000000, yend = 0.125), color="blue", data = v_line_info4,inherit.aes = FALSE) +
      geom_segment(aes(x = start/1000000, y = 0.11, xend = start/1000000, yend = 0.125),  color="blue", data = v_line_info5,inherit.aes = FALSE) +
      geom_segment(aes(x = start/1000000, y = 0.11, xend = start/1000000, yend = 0.125),  color="blue", data = v_line_info6,inherit.aes = FALSE) +
      geom_segment(aes(x = start/1000000, y = 0.11, xend = start/1000000, yend = 0.125),  color="blue", data = v_line_info7,inherit.aes = FALSE) +
      geom_vline(data = v_line_info, mapping = aes(xintercept = start/1000000),  color = "black", size=1) +
      geom_vline(data = v_line_info3, mapping = aes(xintercept = start/1000000),  color = "black", size=1) 
dev.off()
```
